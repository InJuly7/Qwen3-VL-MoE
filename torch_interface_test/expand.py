import torch

print("=" * 60)
print("æƒ…å†µ1: åŽŸå§‹tensoræ˜¯ [4, 1] (2ç»´)")
print("=" * 60)

x1 = torch.tensor([[10], [20], [30], [40]])  # [4, 1]
print(f"åŽŸå§‹ shape: {x1.shape}")

# expand(2, -1, 1) æœ‰3ä¸ªå‚æ•°ï¼Œä½†åŽŸtensoråªæœ‰2ç»´
# PyTorchä¼šè‡ªåŠ¨åœ¨å‰é¢å¢žåŠ ç»´åº¦ï¼
expanded1 = x1.expand(2, -1, 1)
print(f"expand(2, -1, 1) -> {expanded1.shape}")
print(f"æ•°æ®:\n{expanded1}\n")

print("=" * 60)
print("æƒ…å†µ2: åŽŸå§‹tensoræ˜¯ [1, 64, 1] (3ç»´)")
print("=" * 60)

x2 = torch.randn(1, 64, 1)  # [1, 64, 1]
print(f"åŽŸå§‹ shape: {x2.shape}")

# expand(2, -1, 1) æœ‰3ä¸ªå‚æ•°ï¼ŒåŽŸtensorä¹Ÿæ˜¯3ç»´
# ä¸¥æ ¼æŒ‰ç…§ä½ç½®å¯¹åº”ï¼
expanded2 = x2.expand(2, -1, 1)
print(f"expand(2, -1, 1) -> {expanded2.shape}\n")

print("=" * 60)
print("ðŸ”‘ å…³é”®è§„åˆ™ï¼š")
print("=" * 60)
print("å½“ expand å‚æ•°ä¸ªæ•° > åŽŸtensorç»´åº¦æ•°æ—¶ï¼Œä¼šåœ¨å‰é¢æ·»åŠ æ–°ç»´åº¦ï¼")
print()
print("[4, 1] + expand(2, -1, 1):")
print("  æ­¥éª¤1: è‡ªåŠ¨å˜æˆ [1, 4, 1] (å‰é¢è¡¥1)")
print("  æ­¥éª¤2: expand(2, -1, 1) -> [2, 4, 1]")
print()
print("[1, 64, 1] + expand(2, -1, 1):")
print("  ç›´æŽ¥å¯¹åº”: [1->2, 64->64, 1->1] -> [2, 64, 1]")


"""
Output Log:
============================================================
æƒ…å†µ1: åŽŸå§‹tensoræ˜¯ [4, 1] (2ç»´)
============================================================
åŽŸå§‹ shape: torch.Size([4, 1])
expand(2, -1, 1) -> torch.Size([2, 4, 1])
æ•°æ®:
tensor([[[10],
         [20],
         [30],
         [40]],

        [[10],
         [20],
         [30],
         [40]]])

============================================================
æƒ…å†µ2: åŽŸå§‹tensoræ˜¯ [1, 64, 1] (3ç»´)
============================================================
åŽŸå§‹ shape: torch.Size([1, 64, 1])
expand(2, -1, 1) -> torch.Size([2, 64, 1])

============================================================
ðŸ”‘ å…³é”®è§„åˆ™ï¼š
============================================================
å½“ expand å‚æ•°ä¸ªæ•° > åŽŸtensorç»´åº¦æ•°æ—¶ï¼Œä¼šåœ¨å‰é¢æ·»åŠ æ–°ç»´åº¦ï¼

[4, 1] + expand(2, -1, 1):
  æ­¥éª¤1: è‡ªåŠ¨å˜æˆ [1, 4, 1] (å‰é¢è¡¥1)
  æ­¥éª¤2: expand(2, -1, 1) -> [2, 4, 1]

[1, 64, 1] + expand(2, -1, 1):
  ç›´æŽ¥å¯¹åº”: [1->2, 64->64, 1->1] -> [2, 64, 1]
"""
